import subprocess
import time
import socket

# 接続するWi-Fiの設定
SSID = "pepepe-24AES"
CONNECTION_NAME = "pepepe-24AES"  # 通常はSSIDと同じ

def reconnect_wifi():
    print("Wi-Fi再接続中...")
    subprocess.run("nmcli con down '{CONNECTION_NAME}'", shell=True)
    time.sleep(5)
    subprocess.run("nmcli con up '{CONNECTION_NAME}'", shell=True)
    print("再接続完了")

def is_connected():
    try:
        # ルーターに接続できるか確認（Wifi接続の判定）
        socket.create_connection(("192.168.0.1", 80), timeout=3)
        return True
    except OSError:
        return False

if __name__ == "__main__":
    if not is_connected():
        print("ネット未接続。再接続を試みます...")
        reconnect_wifi()
